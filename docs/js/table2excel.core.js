!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ExcelJS")):"function"==typeof define&&define.amd?define(["ExcelJS"],t):"object"==typeof exports?exports.Table2Excel=t(require("ExcelJS")):e.Table2Excel=t(e.ExcelJS)}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r});var o={xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},r=.6},function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n.n(i),l=n(3),u=n(0),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=["workbookCreated","worksheetCreated","worksheetCompleted","workcellCreated"],d={views:[{x:0,y:0,width:1e4,height:2e4,firstSheet:0,activeTab:1,visibility:"visible"}]},p=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"table",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{workbook:d,plugins:[],widthRatio:u.b};r(this,e),this.tables=Array.from("string"==typeof n?document.querySelectorAll(n):n),this.options=o,this.plugins={},s.forEach(function(e){t.plugins[e]=o.plugins.filter(function(t){return t[e]}).map(function(t){return t[e]})}),this.pluginContext={}}return f(e,[{key:"_invokePlugin",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pluginContext=c({},this.pluginContext,n),this.plugins[e].forEach(function(e){return e.call(null,t.pluginContext)})}},{key:"toExcel",value:function(){var e=this,t=this.tables,n=this.options,o=new a.a.Workbook;return Object.assign(o,n),this._invokePlugin("workbookCreated",{workbook:o,tables:t}),t.forEach(function(t,n){var r=o.addWorksheet("Sheet "+(n+1));e._invokePlugin("worksheetCreated",{worksheet:r,table:t}),e.toSheet(t,r),e._invokePlugin("worksheetCompleted",{worksheet:r,table:t})}),this.workbook=o}},{key:"toSheet",value:function(e,t){var n=this,r=e.rows.length,i=Math.max.apply(Math,o(Array.from(e.rows).map(function(e){return e.cells.length}))),a=[];Array.from(e.rows).forEach(function(e){Array.from(e.cells).forEach(function(e){a.push({rowRange:{},colRange:{},el:e})})});for(var u=[],c=0;c<r;c++){for(var f=[],s=0;s<i;s++)f.push({cell:null});u.push(f)}for(var d=0,p=0;p<r;p++)for(var h=0;h<i;h++)if(!u[p][h].cell){var v=a[d++],w=v.el,g=w.rowSpan,b=w.colSpan;v.rowRange={from:p,to:p},v.colRange={from:h,to:h};for(var m=p;m<p+g;m++)for(var y=h;y<h+b;y++)u[m][y].cell=v,v.colRange.to=y,v.rowRange.to=m}a.forEach(function(e){var o=e.rowRange,r=e.colRange,i=e.el,a=i.innerText,u=Object(l.a)(t,r.from,o.from,r.to,o.to),c=getComputedStyle(i);r.from===r.to&&(t.getColumn(r.from+1).width=+c.width.split("px")[0]*n.options.widthRatio),u.value=a,u.style={alignment:{vertical:c.verticalAlign,horizontal:c.textAlign}},n._invokePlugin("workcellCreated",{workcell:u,cell:i})})}},{key:"export",value:function(e,t){this.workbook||this.toExcel(),Object(l.b)(this.workbook,e,t)}}]),e}();t.default=p},function(t,n){t.exports=e},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var o=n(0),r=n(4),i=(n.n(r),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"table",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"xlsx",i=o.a[n];if(!i)return void console.error(n+" file extension is not supported");e.xlsx.writeBuffer().then(function(e){Object(r.saveAs)(new Blob([e.buffer],{type:i}),t+"."+n)})}),a=function(e){var t="A".charCodeAt(0);return String.fromCharCode(t+e-1)},l=function(e){var t=void 0;if((e+=1)<=26)t=a(e);else{var n=e%26,o=Math.floor(e/26);t=0===n?a(o-1)+a(26):a(o)+a(n)}return t},u=function(e,t){return""+l(e)+(t+1)},c=function(e,t,n,o,r){var i=u(t,n),a=u(o,r);return e.mergeCells(i,a),e.getCell(i)}},function(e,t,n){var o,r=r||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in o,i=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},a=/constructor/i.test(e.HTMLElement)||e.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent),u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c=function(e){var t=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()};setTimeout(t,4e4)},f=function(e,t,n){t=[].concat(t);for(var o=t.length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){u(e)}}},s=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,u,d){d||(t=s(t));var p,h=this,v=t.type,w="application/octet-stream"===v,g=function(){f(h,"writestart progress write writeend".split(" "))};if(h.readyState=h.INIT,r)return p=n().createObjectURL(t),void setTimeout(function(){o.href=p,o.download=u,i(o),g(),c(p),h.readyState=h.DONE});!function(){if((l||w&&a)&&e.FileReader){var o=new FileReader;return o.onloadend=function(){var t=l?o.result:o.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,h.readyState=h.DONE,g()},o.readAsDataURL(t),void(h.readyState=h.INIT)}if(p||(p=n().createObjectURL(t)),w)e.location.href=p;else{e.open(p,"_blank")||(e.location.href=p)}h.readyState=h.DONE,g(),c(p)}()},p=d.prototype,h=function(e,t,n){return new d(e,t||e.name||"download",n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=s(e)),navigator.msSaveOrOpenBlob(e,t)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,h)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==e&&e.exports?e.exports.saveAs=r:null!==n(5)&&null!==n(6)&&void 0!==(o=function(){return r}.call(t,n,t,e))&&(e.exports=o)},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(t,{})}]).default});